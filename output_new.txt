Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 224, 224, 3) 0                                            
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 112, 112, 16) 2352        input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 112, 112, 16) 64          conv2d[0][0]                     
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 37, 37, 16)   0           batch_normalization[0][0]        
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 19, 19, 16)   2304        max_pooling2d[0][0]              
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 19, 19, 16)   64          conv2d_1[0][0]                   
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 19, 19, 16)   2304        batch_normalization_1[0][0]      
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 19, 19, 16)   64          conv2d_2[0][0]                   
__________________________________________________________________________________________________
add (Add)                       (None, 19, 19, 16)   0           batch_normalization_1[0][0]      
                                                                 batch_normalization_2[0][0]      
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 19, 19, 16)   2304        add[0][0]                        
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 19, 19, 16)   64          conv2d_3[0][0]                   
__________________________________________________________________________________________________
add_1 (Add)                     (None, 19, 19, 16)   0           add[0][0]                        
                                                                 batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 10, 10, 32)   4608        add_1[0][0]                      
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 10, 10, 32)   128         conv2d_4[0][0]                   
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 10, 10, 32)   9216        batch_normalization_4[0][0]      
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 10, 10, 32)   128         conv2d_5[0][0]                   
__________________________________________________________________________________________________
add_2 (Add)                     (None, 10, 10, 32)   0           batch_normalization_4[0][0]      
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 10, 10, 32)   9216        add_2[0][0]                      
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 10, 10, 32)   128         conv2d_6[0][0]                   
__________________________________________________________________________________________________
add_3 (Add)                     (None, 10, 10, 32)   0           add_2[0][0]                      
                                                                 batch_normalization_6[0][0]      
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 5, 5, 64)     18432       add_3[0][0]                      
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 5, 5, 64)     256         conv2d_7[0][0]                   
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 5, 5, 64)     36864       batch_normalization_7[0][0]      
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 5, 5, 64)     256         conv2d_8[0][0]                   
__________________________________________________________________________________________________
add_4 (Add)                     (None, 5, 5, 64)     0           batch_normalization_7[0][0]      
                                                                 batch_normalization_8[0][0]      
__________________________________________________________________________________________________
conv2d_9 (Conv2D)               (None, 5, 5, 64)     36864       add_4[0][0]                      
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 5, 5, 64)     256         conv2d_9[0][0]                   
__________________________________________________________________________________________________
add_5 (Add)                     (None, 5, 5, 64)     0           add_4[0][0]                      
                                                                 batch_normalization_9[0][0]      
__________________________________________________________________________________________________
conv2d_10 (Conv2D)              (None, 3, 3, 128)    73728       add_5[0][0]                      
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 3, 3, 128)    512         conv2d_10[0][0]                  
__________________________________________________________________________________________________
conv2d_11 (Conv2D)              (None, 3, 3, 128)    147456      batch_normalization_10[0][0]     
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 3, 3, 128)    512         conv2d_11[0][0]                  
__________________________________________________________________________________________________
add_6 (Add)                     (None, 3, 3, 128)    0           batch_normalization_10[0][0]     
                                                                 batch_normalization_11[0][0]     
__________________________________________________________________________________________________
conv2d_12 (Conv2D)              (None, 3, 3, 128)    147456      add_6[0][0]                      
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 3, 3, 128)    512         conv2d_12[0][0]                  
__________________________________________________________________________________________________
add_7 (Add)                     (None, 3, 3, 128)    0           add_6[0][0]                      
                                                                 batch_normalization_12[0][0]     
__________________________________________________________________________________________________
conv2d_13 (Conv2D)              (None, 2, 2, 512)    589824      add_7[0][0]                      
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 2, 2, 512)    2048        conv2d_13[0][0]                  
__________________________________________________________________________________________________
conv2d_14 (Conv2D)              (None, 2, 2, 512)    2359296     batch_normalization_13[0][0]     
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 2, 2, 512)    2048        conv2d_14[0][0]                  
__________________________________________________________________________________________________
add_8 (Add)                     (None, 2, 2, 512)    0           batch_normalization_13[0][0]     
                                                                 batch_normalization_14[0][0]     
__________________________________________________________________________________________________
conv2d_15 (Conv2D)              (None, 2, 2, 512)    2359296     add_8[0][0]                      
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 2, 2, 512)    2048        conv2d_15[0][0]                  
__________________________________________________________________________________________________
add_9 (Add)                     (None, 2, 2, 512)    0           add_8[0][0]                      
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
global_average_pooling2d (Globa (None, 512)          0           add_9[0][0]                      
__________________________________________________________________________________________________
flatten (Flatten)               (None, 512)          0           global_average_pooling2d[0][0]   
__________________________________________________________________________________________________
dropout (Dropout)               (None, 512)          0           flatten[0][0]                    
__________________________________________________________________________________________________
dense (Dense)                   (None, 32)           16384       dropout[0][0]                    
__________________________________________________________________________________________________
lambda (Lambda)                 (None, 32)           0           dense[0][0]                      
==================================================================================================
Total params: 5,826,992
Trainable params: 5,822,448
Non-trainable params: 4,544
__________________________________________________________________________________________________
None
WARNING:tensorflow:From /home/zhao/DogFaceNet/dogfacenet/online_training.py:328: Model.predict_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.predict, which supports generators.
Beginning epoch number: 0
Current hard triplet ratio: 0.8187307530779818
WARNING:tensorflow:From dogfacenet/dogfacenet.py:214: Model.fit_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.fit, which supports generators.
300/300 [==============================] - 217s 723ms/step - loss: 6.0850 - triplet_acc: 0.3843 - val_loss: 5.2923 - val_triplet_acc: 0.3800
Beginning epoch number: 1
Current hard triplet ratio: 0.1315557236697526
300/300 [==============================] - 168s 560ms/step - loss: 4.6754 - triplet_acc: 0.4110 - val_loss: 5.0159 - val_triplet_acc: 0.4433
Beginning epoch number: 2
Current hard triplet ratio: 0.2104563680753927
300/300 [==============================] - 167s 557ms/step - loss: 4.7696 - triplet_acc: 0.3737 - val_loss: 6.2046 - val_triplet_acc: 0.3933
Beginning epoch number: 3
Current hard triplet ratio: 0.2039503781452735
300/300 [==============================] - 167s 556ms/step - loss: 4.6016 - triplet_acc: 0.3813 - val_loss: 4.0908 - val_triplet_acc: 0.4333
Beginning epoch number: 4
Current hard triplet ratio: 0.2157006175999136
300/300 [==============================] - 167s 557ms/step - loss: 4.5210 - triplet_acc: 0.3420 - val_loss: 5.0395 - val_triplet_acc: 0.4167
Beginning epoch number: 5
Current hard triplet ratio: 0.22157349843583554
300/300 [==============================] - 167s 555ms/step - loss: 4.0654 - triplet_acc: 0.3100 - val_loss: 3.2749 - val_triplet_acc: 0.2267
Beginning epoch number: 6
Current hard triplet ratio: 0.25791117139774355
300/300 [==============================] - 183s 612ms/step - loss: 3.2520 - triplet_acc: 0.2013 - val_loss: 3.0216 - val_triplet_acc: 0.0367
Beginning epoch number: 7
Current hard triplet ratio: 0.33823817953958357
300/300 [==============================] - 183s 610ms/step - loss: 2.9909 - triplet_acc: 0.0963 - val_loss: 2.6719 - val_triplet_acc: 0.0133
Beginning epoch number: 8
Current hard triplet ratio: 0.3689977352322889
300/300 [==============================] - 183s 609ms/step - loss: 2.7728 - triplet_acc: 0.1457 - val_loss: 3.1450 - val_triplet_acc: 0.0700
Beginning epoch number: 9
Current hard triplet ratio: 0.39681616997864555
300/300 [==============================] - 183s 611ms/step - loss: 2.7782 - triplet_acc: 0.1470 - val_loss: 2.9595 - val_triplet_acc: 0.0100
Beginning epoch number: 10
Current hard triplet ratio: 0.39610793394916843
300/300 [==============================] - 183s 609ms/step - loss: 2.5711 - triplet_acc: 0.1753 - val_loss: 3.0971 - val_triplet_acc: 0.0000e+00
Beginning epoch number: 11
Current hard triplet ratio: 0.42442502801621246
300/300 [==============================] - 183s 611ms/step - loss: 2.5471 - triplet_acc: 0.1930 - val_loss: 2.9279 - val_triplet_acc: 0.0533
Beginning epoch number: 12
Current hard triplet ratio: 0.4278324040128241
300/300 [==============================] - 182s 605ms/step - loss: 2.4090 - triplet_acc: 0.2257 - val_loss: 2.4391 - val_triplet_acc: 0.1767
Beginning epoch number: 13
Current hard triplet ratio: 0.4479840416206044
300/300 [==============================] - 182s 607ms/step - loss: 2.2156 - triplet_acc: 0.2827 - val_loss: 2.6003 - val_triplet_acc: 0.0200
Beginning epoch number: 14
Current hard triplet ratio: 0.4778170418263829
300/300 [==============================] - 182s 607ms/step - loss: 2.1469 - triplet_acc: 0.3033 - val_loss: 2.7310 - val_triplet_acc: 0.0633
Beginning epoch number: 15
Current hard triplet ratio: 0.4888901688617206
300/300 [==============================] - 183s 610ms/step - loss: 2.0219 - triplet_acc: 0.3547 - val_loss: 3.3363 - val_triplet_acc: 0.1833
Beginning epoch number: 16
Current hard triplet ratio: 0.5096782541177485
300/300 [==============================] - 199s 664ms/step - loss: 2.0630 - triplet_acc: 0.3273 - val_loss: 2.2368 - val_triplet_acc: 0.2233
Beginning epoch number: 17
Current hard triplet ratio: 0.5027417126708963
300/300 [==============================] - 196s 655ms/step - loss: 1.8512 - triplet_acc: 0.3967 - val_loss: 3.0061 - val_triplet_acc: 0.1033
Beginning epoch number: 18
Current hard triplet ratio: 0.5395259279178982
300/300 [==============================] - 197s 657ms/step - loss: 1.7533 - triplet_acc: 0.4243 - val_loss: 2.3089 - val_triplet_acc: 0.2300
Beginning epoch number: 19
Current hard triplet ratio: 0.5574278999188363
300/300 [==============================] - 199s 663ms/step - loss: 1.7372 - triplet_acc: 0.4390 - val_loss: 2.2982 - val_triplet_acc: 0.2133
Beginning epoch number: 20
Current hard triplet ratio: 0.5604269682605243
300/300 [==============================] - 196s 654ms/step - loss: 1.5004 - triplet_acc: 0.5177 - val_loss: 2.8115 - val_triplet_acc: 0.2367
Beginning epoch number: 21
Current hard triplet ratio: 0.606457661077277
300/300 [==============================] - 200s 668ms/step - loss: 1.5519 - triplet_acc: 0.4940 - val_loss: 2.4400 - val_triplet_acc: 0.3033
Beginning epoch number: 22
Current hard triplet ratio: 0.5961277271260008
300/300 [==============================] - 201s 669ms/step - loss: 1.2931 - triplet_acc: 0.5717 - val_loss: 3.0840 - val_triplet_acc: 0.2500
Beginning epoch number: 23
Current hard triplet ratio: 0.6498299416510486
300/300 [==============================] - 199s 663ms/step - loss: 1.3106 - triplet_acc: 0.5703 - val_loss: 2.6989 - val_triplet_acc: 0.2967
Beginning epoch number: 24
Current hard triplet ratio: 0.6460651051765414
300/300 [==============================] - 199s 664ms/step - loss: 1.2058 - triplet_acc: 0.6030 - val_loss: 2.5731 - val_triplet_acc: 0.3633
Beginning epoch number: 25
Current hard triplet ratio: 0.6690316604862157
300/300 [==============================] - 200s 668ms/step - loss: 1.1228 - triplet_acc: 0.6350 - val_loss: 2.7055 - val_triplet_acc: 0.2933
Beginning epoch number: 26
Current hard triplet ratio: 0.6878020593009272
300/300 [==============================] - 198s 660ms/step - loss: 1.0654 - triplet_acc: 0.6483 - val_loss: 2.7130 - val_triplet_acc: 0.3967
Beginning epoch number: 27
Current hard triplet ratio: 0.7010802929243856
300/300 [==============================] - 199s 665ms/step - loss: 1.0941 - triplet_acc: 0.6407 - val_loss: 2.8265 - val_triplet_acc: 0.2900
Beginning epoch number: 28
Current hard triplet ratio: 0.6944020717843205
300/300 [==============================] - 198s 660ms/step - loss: 0.8670 - triplet_acc: 0.7200 - val_loss: 3.0431 - val_triplet_acc: 0.3800
Beginning epoch number: 29
Current hard triplet ratio: 0.7490181472066705
300/300 [==============================] - 199s 662ms/step - loss: 0.8652 - triplet_acc: 0.7117 - val_loss: 3.8358 - val_triplet_acc: 0.2800
Beginning epoch number: 30
Current hard triplet ratio: 0.749451402988829
300/300 [==============================] - 199s 664ms/step - loss: 0.9016 - triplet_acc: 0.7157 - val_loss: 3.8310 - val_triplet_acc: 0.2667
Beginning epoch number: 31
Current hard triplet ratio: 0.7404196768570496
300/300 [==============================] - 201s 670ms/step - loss: 0.8891 - triplet_acc: 0.7147 - val_loss: 3.1554 - val_triplet_acc: 0.3233
Beginning epoch number: 32
Current hard triplet ratio: 0.7435115318412949
300/300 [==============================] - 199s 664ms/step - loss: 0.7054 - triplet_acc: 0.7653 - val_loss: 3.5767 - val_triplet_acc: 0.2800
Beginning epoch number: 33
Current hard triplet ratio: 0.79046277995358
300/300 [==============================] - 213s 709ms/step - loss: 0.6645 - triplet_acc: 0.7700 - val_loss: 3.1346 - val_triplet_acc: 0.3233
Beginning epoch number: 34
Current hard triplet ratio: 0.801305239927517
300/300 [==============================] - 215s 716ms/step - loss: 0.9107 - triplet_acc: 0.7110 - val_loss: 3.2825 - val_triplet_acc: 0.3100
Beginning epoch number: 35
Current hard triplet ratio: 0.7381904522524578
300/300 [==============================] - 200s 668ms/step - loss: 0.6784 - triplet_acc: 0.7893 - val_loss: 3.3834 - val_triplet_acc: 0.4267
Beginning epoch number: 36
Current hard triplet ratio: 0.7976248097770863
300/300 [==============================] - 215s 717ms/step - loss: 0.6939 - triplet_acc: 0.7670 - val_loss: 4.0486 - val_triplet_acc: 0.3367
Beginning epoch number: 37
Current hard triplet ratio: 0.7934938154029519
300/300 [==============================] - 213s 711ms/step - loss: 0.6513 - triplet_acc: 0.7860 - val_loss: 3.9797 - val_triplet_acc: 0.3267
Beginning epoch number: 38
Current hard triplet ratio: 0.8048425847693363
300/300 [==============================] - 214s 713ms/step - loss: 0.5617 - triplet_acc: 0.7967 - val_loss: 3.4243 - val_triplet_acc: 0.3400
Beginning epoch number: 39
Current hard triplet ratio: 0.8292437509010556
300/300 [==============================] - 215s 716ms/step - loss: 0.5263 - triplet_acc: 0.8167 - val_loss: 3.5619 - val_triplet_acc: 0.3867
Beginning epoch number: 40
Current hard triplet ratio: 0.8391065016299764
300/300 [==============================] - 212s 706ms/step - loss: 0.6200 - triplet_acc: 0.8053 - val_loss: 3.7057 - val_triplet_acc: 0.4267
Beginning epoch number: 41
Current hard triplet ratio: 0.8132864022322522
300/300 [==============================] - 215s 718ms/step - loss: 0.5873 - triplet_acc: 0.8117 - val_loss: 4.0592 - val_triplet_acc: 0.3233
Beginning epoch number: 42
Current hard triplet ratio: 0.8222128152022553
300/300 [==============================] - 214s 715ms/step - loss: 0.3943 - triplet_acc: 0.8573 - val_loss: 3.9293 - val_triplet_acc: 0.3733
Beginning epoch number: 43
Current hard triplet ratio: 0.8768299029260542
300/300 [==============================] - 211s 702ms/step - loss: 0.3962 - triplet_acc: 0.8610 - val_loss: 4.4932 - val_triplet_acc: 0.3400
Beginning epoch number: 44
Current hard triplet ratio: 0.876281207234298
300/300 [==============================] - 214s 713ms/step - loss: 0.4627 - triplet_acc: 0.8490 - val_loss: 3.6027 - val_triplet_acc: 0.4000
Beginning epoch number: 45
Current hard triplet ratio: 0.8570668774635499
300/300 [==============================] - 215s 715ms/step - loss: 0.3478 - triplet_acc: 0.8723 - val_loss: 3.9664 - val_triplet_acc: 0.4033
Beginning epoch number: 46
Current hard triplet ratio: 0.8905304274985912
300/300 [==============================] - 216s 719ms/step - loss: 0.3780 - triplet_acc: 0.8760 - val_loss: 3.7922 - val_triplet_acc: 0.3533
Beginning epoch number: 47
Current hard triplet ratio: 0.8816121694145379
300/300 [==============================] - 216s 718ms/step - loss: 0.3206 - triplet_acc: 0.8840 - val_loss: 3.5716 - val_triplet_acc: 0.4867
Beginning epoch number: 48
Current hard triplet ratio: 0.898635315431005
300/300 [==============================] - 215s 717ms/step - loss: 0.3846 - triplet_acc: 0.8757 - val_loss: 4.7003 - val_triplet_acc: 0.3633
Beginning epoch number: 49
Current hard triplet ratio: 0.8796866066450787
300/300 [==============================] - 214s 712ms/step - loss: 0.2979 - triplet_acc: 0.8937 - val_loss: 3.7100 - val_triplet_acc: 0.3600
Beginning epoch number: 50
Current hard triplet ratio: 0.9054585255709228
300/300 [==============================] - 212s 707ms/step - loss: 0.4478 - triplet_acc: 0.8543 - val_loss: 3.9169 - val_triplet_acc: 0.3700
Beginning epoch number: 51
Current hard triplet ratio: 0.8613343680356826
300/300 [==============================] - 214s 712ms/step - loss: 0.3115 - triplet_acc: 0.8957 - val_loss: 4.1762 - val_triplet_acc: 0.4067
Beginning epoch number: 52
Current hard triplet ratio: 0.9013684274150032
300/300 [==============================] - 214s 712ms/step - loss: 0.2423 - triplet_acc: 0.9127 - val_loss: 4.2648 - val_triplet_acc: 0.3833
Beginning epoch number: 53
Current hard triplet ratio: 0.9224122843510731
300/300 [==============================] - 215s 716ms/step - loss: 0.2215 - triplet_acc: 0.9203 - val_loss: 3.9425 - val_triplet_acc: 0.3933
Beginning epoch number: 54
Current hard triplet ratio: 0.9288263117763856
300/300 [==============================] - 216s 722ms/step - loss: 0.2758 - triplet_acc: 0.9113 - val_loss: 4.9698 - val_triplet_acc: 0.3200
Beginning epoch number: 55
Current hard triplet ratio: 0.9121596186474521
300/300 [==============================] - 215s 717ms/step - loss: 0.2319 - triplet_acc: 0.9177 - val_loss: 4.3905 - val_triplet_acc: 0.4467
Beginning epoch number: 56
Current hard triplet ratio: 0.9256131561508881
300/300 [==============================] - 216s 720ms/step - loss: 0.2210 - triplet_acc: 0.9207 - val_loss: 4.9663 - val_triplet_acc: 0.4100
Beginning epoch number: 57
Current hard triplet ratio: 0.9289717739320467
300/300 [==============================] - 215s 716ms/step - loss: 0.2407 - triplet_acc: 0.9203 - val_loss: 4.2109 - val_triplet_acc: 0.3533
Beginning epoch number: 58
Current hard triplet ratio: 0.9228856145177828
300/300 [==============================] - 216s 720ms/step - loss: 0.1706 - triplet_acc: 0.9307 - val_loss: 4.1411 - val_triplet_acc: 0.3933
Beginning epoch number: 59
Current hard triplet ratio: 0.9447085984623644
300/300 [==============================] - 215s 716ms/step - loss: 0.2168 - triplet_acc: 0.9233 - val_loss: 4.1384 - val_triplet_acc: 0.3933
Beginning epoch number: 60
Current hard triplet ratio: 0.9302943472304243
300/300 [==============================] - 213s 711ms/step - loss: 0.2854 - triplet_acc: 0.9077 - val_loss: 4.9095 - val_triplet_acc: 0.4300
Beginning epoch number: 61
Current hard triplet ratio: 0.9092383508000372
300/300 [==============================] - 216s 719ms/step - loss: 0.2324 - triplet_acc: 0.9163 - val_loss: 4.2010 - val_triplet_acc: 0.4033
Beginning epoch number: 62
Current hard triplet ratio: 0.925471106727714
300/300 [==============================] - 216s 719ms/step - loss: 0.1293 - triplet_acc: 0.9530 - val_loss: 4.4125 - val_triplet_acc: 0.3867
Beginning epoch number: 63
Current hard triplet ratio: 0.9578238157829185
300/300 [==============================] - 214s 712ms/step - loss: 0.1054 - triplet_acc: 0.9553 - val_loss: 4.6987 - val_triplet_acc: 0.3733
Beginning epoch number: 64
Current hard triplet ratio: 0.9654710055772021
300/300 [==============================] - 216s 719ms/step - loss: 0.2150 - triplet_acc: 0.9310 - val_loss: 4.1417 - val_triplet_acc: 0.3933
Beginning epoch number: 65
Current hard triplet ratio: 0.930843384281499
300/300 [==============================] - 215s 716ms/step - loss: 0.1671 - triplet_acc: 0.9373 - val_loss: 4.7306 - val_triplet_acc: 0.4100
Beginning epoch number: 66
Current hard triplet ratio: 0.945829530912551
300/300 [==============================] - 215s 717ms/step - loss: 0.1257 - triplet_acc: 0.9473 - val_loss: 4.4737 - val_triplet_acc: 0.3900
Beginning epoch number: 67
Current hard triplet ratio: 0.9589782292876514
300/300 [==============================] - 216s 719ms/step - loss: 0.1358 - triplet_acc: 0.9517 - val_loss: 4.6116 - val_triplet_acc: 0.3867
Beginning epoch number: 68
Current hard triplet ratio: 0.9557513405530348
300/300 [==============================] - 215s 717ms/step - loss: 0.1792 - triplet_acc: 0.9407 - val_loss: 4.6575 - val_triplet_acc: 0.4233
Beginning epoch number: 69
Current hard triplet ratio: 0.9420018657810961
300/300 [==============================] - 214s 713ms/step - loss: 0.1602 - triplet_acc: 0.9480 - val_loss: 3.7910 - val_triplet_acc: 0.4967
Beginning epoch number: 70
Current hard triplet ratio: 0.9480064528626009
300/300 [==============================] - 214s 712ms/step - loss: 0.1503 - triplet_acc: 0.9477 - val_loss: 5.0444 - val_triplet_acc: 0.3567
Beginning epoch number: 71
Current hard triplet ratio: 0.9511369484458496
300/300 [==============================] - 215s 716ms/step - loss: 0.1192 - triplet_acc: 0.9593 - val_loss: 4.8543 - val_triplet_acc: 0.3567
Beginning epoch number: 72
Current hard triplet ratio: 0.961039898713728
300/300 [==============================] - 215s 718ms/step - loss: 0.1301 - triplet_acc: 0.9497 - val_loss: 3.8355 - val_triplet_acc: 0.4367
Beginning epoch number: 73
Current hard triplet ratio: 0.9575620000977266
300/300 [==============================] - 218s 727ms/step - loss: 0.1459 - triplet_acc: 0.9473 - val_loss: 4.8454 - val_triplet_acc: 0.3367
Beginning epoch number: 74
Current hard triplet ratio: 0.9525385084135055
300/300 [==============================] - 216s 719ms/step - loss: 0.0731 - triplet_acc: 0.9700 - val_loss: 5.4476 - val_triplet_acc: 0.3833
Beginning epoch number: 75
Current hard triplet ratio: 0.9759249800930008
300/300 [==============================] - 215s 716ms/step - loss: 0.1359 - triplet_acc: 0.9530 - val_loss: 4.3470 - val_triplet_acc: 0.4367
Beginning epoch number: 76
Current hard triplet ratio: 0.9557118725796442
300/300 [==============================] - 219s 729ms/step - loss: 0.1805 - triplet_acc: 0.9357 - val_loss: 5.0142 - val_triplet_acc: 0.4233
Beginning epoch number: 77
Current hard triplet ratio: 0.9416072208763547
300/300 [==============================] - 214s 714ms/step - loss: 0.1066 - triplet_acc: 0.9617 - val_loss: 4.3066 - val_triplet_acc: 0.4767
Beginning epoch number: 78
Current hard triplet ratio: 0.9650966874563492
300/300 [==============================] - 217s 723ms/step - loss: 0.1511 - triplet_acc: 0.9497 - val_loss: 4.5979 - val_triplet_acc: 0.4800
Beginning epoch number: 79
Current hard triplet ratio: 0.9508858116276898
300/300 [==============================] - 214s 712ms/step - loss: 0.1124 - triplet_acc: 0.9600 - val_loss: 4.7066 - val_triplet_acc: 0.4167
Beginning epoch number: 80
Current hard triplet ratio: 0.9632389250839001
300/300 [==============================] - 218s 726ms/step - loss: 0.1498 - triplet_acc: 0.9553 - val_loss: 5.7666 - val_triplet_acc: 0.3900
Beginning epoch number: 81
Current hard triplet ratio: 0.9512834475956079
300/300 [==============================] - 214s 715ms/step - loss: 0.1072 - triplet_acc: 0.9597 - val_loss: 5.1782 - val_triplet_acc: 0.3533
Beginning epoch number: 82
Current hard triplet ratio: 0.9649135068997263
300/300 [==============================] - 215s 717ms/step - loss: 0.1312 - triplet_acc: 0.9540 - val_loss: 4.6801 - val_triplet_acc: 0.4233
Beginning epoch number: 83
Current hard triplet ratio: 0.9572171428541133
300/300 [==============================] - 218s 727ms/step - loss: 0.0961 - triplet_acc: 0.9657 - val_loss: 4.2214 - val_triplet_acc: 0.3933
Beginning epoch number: 84
Current hard triplet ratio: 0.9684691342294561
300/300 [==============================] - 216s 720ms/step - loss: 0.1281 - triplet_acc: 0.9527 - val_loss: 4.6645 - val_triplet_acc: 0.4233
Beginning epoch number: 85
Current hard triplet ratio: 0.9582116070504932
300/300 [==============================] - 215s 717ms/step - loss: 0.1447 - triplet_acc: 0.9547 - val_loss: 4.6493 - val_triplet_acc: 0.3433
Beginning epoch number: 86
Current hard triplet ratio: 0.9529209507129832
300/300 [==============================] - 214s 712ms/step - loss: 0.0743 - triplet_acc: 0.9680 - val_loss: 5.4648 - val_triplet_acc: 0.4100
Beginning epoch number: 87
Current hard triplet ratio: 0.9755214412295601
300/300 [==============================] - 215s 718ms/step - loss: 0.0924 - triplet_acc: 0.9673 - val_loss: 5.1973 - val_triplet_acc: 0.3733
Beginning epoch number: 88
Current hard triplet ratio: 0.9696593902123138
300/300 [==============================] - 216s 720ms/step - loss: 0.0787 - triplet_acc: 0.9690 - val_loss: 3.9330 - val_triplet_acc: 0.3300
Beginning epoch number: 89
Current hard triplet ratio: 0.9741008189227978
300/300 [==============================] - 216s 719ms/step - loss: 0.1095 - triplet_acc: 0.9643 - val_loss: 4.7858 - val_triplet_acc: 0.3833
Beginning epoch number: 90
Current hard triplet ratio: 0.9641623997566805
300/300 [==============================] - 213s 711ms/step - loss: 0.1010 - triplet_acc: 0.9630 - val_loss: 4.8793 - val_triplet_acc: 0.3767
Beginning epoch number: 91
Current hard triplet ratio: 0.9668801732191064
300/300 [==============================] - 213s 711ms/step - loss: 0.0705 - triplet_acc: 0.9707 - val_loss: 5.1201 - val_triplet_acc: 0.3367
Beginning epoch number: 92
Current hard triplet ratio: 0.9767875032698439
300/300 [==============================] - 213s 709ms/step - loss: 0.0849 - triplet_acc: 0.9713 - val_loss: 4.2129 - val_triplet_acc: 0.3800
Beginning epoch number: 93
Current hard triplet ratio: 0.9721002601247875
300/300 [==============================] - 214s 713ms/step - loss: 0.1058 - triplet_acc: 0.9627 - val_loss: 5.1814 - val_triplet_acc: 0.3700
Beginning epoch number: 94
Current hard triplet ratio: 0.9653446368147702
300/300 [==============================] - 214s 715ms/step - loss: 0.1040 - triplet_acc: 0.9647 - val_loss: 5.0210 - val_triplet_acc: 0.3833
Beginning epoch number: 95
Current hard triplet ratio: 0.9659153192427113
300/300 [==============================] - 214s 712ms/step - loss: 0.0722 - triplet_acc: 0.9690 - val_loss: 4.5592 - val_triplet_acc: 0.4133
Beginning epoch number: 96
Current hard triplet ratio: 0.9762059436394765
300/300 [==============================] - 214s 713ms/step - loss: 0.1119 - triplet_acc: 0.9587 - val_loss: 4.4545 - val_triplet_acc: 0.3500
Beginning epoch number: 97
Current hard triplet ratio: 0.9633844123454302
300/300 [==============================] - 213s 709ms/step - loss: 0.0760 - triplet_acc: 0.9720 - val_loss: 4.6107 - val_triplet_acc: 0.4800
Beginning epoch number: 98
Current hard triplet ratio: 0.9749812824507533
300/300 [==============================] - 212s 708ms/step - loss: 0.0690 - triplet_acc: 0.9757 - val_loss: 3.2013 - val_triplet_acc: 0.4233
Beginning epoch number: 99
Current hard triplet ratio: 0.9772546449716375
300/300 [==============================] - 214s 713ms/step - loss: 0.0914 - triplet_acc: 0.9673 - val_loss: 4.7475 - val_triplet_acc: 0.4267
Beginning epoch number: 100
Current hard triplet ratio: 0.9700041094995157
300/300 [==============================] - 215s 716ms/step - loss: 0.1023 - triplet_acc: 0.9633 - val_loss: 5.0763 - val_triplet_acc: 0.4100
Beginning epoch number: 101
Current hard triplet ratio: 0.9664679553578281
300/300 [==============================] - 215s 717ms/step - loss: 0.0862 - triplet_acc: 0.9663 - val_loss: 4.8372 - val_triplet_acc: 0.3900
Beginning epoch number: 102
Current hard triplet ratio: 0.9716613109250475
300/300 [==============================] - 216s 719ms/step - loss: 0.0819 - triplet_acc: 0.9727 - val_loss: 4.7791 - val_triplet_acc: 0.3800
Beginning epoch number: 103
Current hard triplet ratio: 0.973080407887663
300/300 [==============================] - 215s 718ms/step - loss: 0.0824 - triplet_acc: 0.9707 - val_loss: 4.9443 - val_triplet_acc: 0.3967
Beginning epoch number: 104
Current hard triplet ratio: 0.97290889492331
300/300 [==============================] - 217s 725ms/step - loss: 0.0901 - triplet_acc: 0.9703 - val_loss: 4.1690 - val_triplet_acc: 0.4633
Beginning epoch number: 105
Current hard triplet ratio: 0.9704226822413522
300/300 [==============================] - 215s 718ms/step - loss: 0.0716 - triplet_acc: 0.9713 - val_loss: 4.7031 - val_triplet_acc: 0.3833
Beginning epoch number: 106
Current hard triplet ratio: 0.9764108831325496
300/300 [==============================] - 216s 720ms/step - loss: 0.0859 - triplet_acc: 0.9660 - val_loss: 5.0844 - val_triplet_acc: 0.4000
Beginning epoch number: 107
Current hard triplet ratio: 0.9717714097532837
300/300 [==============================] - 213s 710ms/step - loss: 0.0476 - triplet_acc: 0.9800 - val_loss: 5.6075 - val_triplet_acc: 0.3700
Beginning epoch number: 108
Current hard triplet ratio: 0.9842652199653414
300/300 [==============================] - 215s 717ms/step - loss: 0.0823 - triplet_acc: 0.9710 - val_loss: 5.5960 - val_triplet_acc: 0.3767
Beginning epoch number: 109
Current hard triplet ratio: 0.9729418820644287
300/300 [==============================] - 214s 714ms/step - loss: 0.0756 - triplet_acc: 0.9727 - val_loss: 4.9867 - val_triplet_acc: 0.3500
Beginning epoch number: 110
Current hard triplet ratio: 0.9751292819101754
300/300 [==============================] - 215s 715ms/step - loss: 0.0921 - triplet_acc: 0.9650 - val_loss: 5.6100 - val_triplet_acc: 0.3400
Beginning epoch number: 111
Current hard triplet ratio: 0.9697576053848118
300/300 [==============================] - 215s 716ms/step - loss: 0.0888 - triplet_acc: 0.9663 - val_loss: 4.3965 - val_triplet_acc: 0.4633
Beginning epoch number: 112
Current hard triplet ratio: 0.9708267713391582
300/300 [==============================] - 215s 718ms/step - loss: 0.0783 - triplet_acc: 0.9720 - val_loss: 3.9683 - val_triplet_acc: 0.4700
Beginning epoch number: 113
Current hard triplet ratio: 0.9742416147642768
300/300 [==============================] - 214s 712ms/step - loss: 0.0842 - triplet_acc: 0.9723 - val_loss: 4.9227 - val_triplet_acc: 0.3667
Beginning epoch number: 114
Current hard triplet ratio: 0.9723238804115971
300/300 [==============================] - 215s 718ms/step - loss: 0.0474 - triplet_acc: 0.9813 - val_loss: 4.5205 - val_triplet_acc: 0.3900
Beginning epoch number: 115
Current hard triplet ratio: 0.9843316012194618
300/300 [==============================] - 217s 723ms/step - loss: 0.0433 - triplet_acc: 0.9820 - val_loss: 4.7728 - val_triplet_acc: 0.3833
Beginning epoch number: 116
Current hard triplet ratio: 0.98566708957924
300/300 [==============================] - 215s 716ms/step - loss: 0.0685 - triplet_acc: 0.9770 - val_loss: 4.8008 - val_triplet_acc: 0.3900
Beginning epoch number: 117
Current hard triplet ratio: 0.9774195639938761
300/300 [==============================] - 215s 718ms/step - loss: 0.0823 - triplet_acc: 0.9737 - val_loss: 4.1126 - val_triplet_acc: 0.4433
Beginning epoch number: 118
Current hard triplet ratio: 0.9729430757308485
300/300 [==============================] - 218s 727ms/step - loss: 0.1085 - triplet_acc: 0.9690 - val_loss: 4.9831 - val_triplet_acc: 0.3633
Beginning epoch number: 119
Current hard triplet ratio: 0.9644726625445202
300/300 [==============================] - 215s 716ms/step - loss: 0.0830 - triplet_acc: 0.9730 - val_loss: 4.9483 - val_triplet_acc: 0.4167
Beginning epoch number: 120
Current hard triplet ratio: 0.97270914026474
300/300 [==============================] - 216s 721ms/step - loss: 0.0731 - triplet_acc: 0.9717 - val_loss: 4.7625 - val_triplet_acc: 0.4100
Beginning epoch number: 121
Current hard triplet ratio: 0.9759201592941886
300/300 [==============================] - 214s 714ms/step - loss: 0.0632 - triplet_acc: 0.9793 - val_loss: 5.1810 - val_triplet_acc: 0.3367
Beginning epoch number: 122
Current hard triplet ratio: 0.9791627302138937
300/300 [==============================] - 214s 715ms/step - loss: 0.0629 - triplet_acc: 0.9793 - val_loss: 4.6853 - val_triplet_acc: 0.3700
Beginning epoch number: 123
Current hard triplet ratio: 0.9792360753534521
300/300 [==============================] - 215s 716ms/step - loss: 0.0625 - triplet_acc: 0.9793 - val_loss: 5.3512 - val_triplet_acc: 0.3767
Beginning epoch number: 124
Current hard triplet ratio: 0.979384742569612
300/300 [==============================] - 214s 712ms/step - loss: 0.0496 - triplet_acc: 0.9777 - val_loss: 4.9391 - val_triplet_acc: 0.3100
Beginning epoch number: 125
Current hard triplet ratio: 0.9836133155897422
300/300 [==============================] - 217s 722ms/step - loss: 0.0771 - triplet_acc: 0.9753 - val_loss: 4.7627 - val_triplet_acc: 0.4200
Beginning epoch number: 126
Current hard triplet ratio: 0.974623064553782
300/300 [==============================] - 217s 723ms/step - loss: 0.0914 - triplet_acc: 0.9643 - val_loss: 5.6980 - val_triplet_acc: 0.2700
Beginning epoch number: 127
Current hard triplet ratio: 0.9700088938474083
300/300 [==============================] - 216s 721ms/step - loss: 0.0648 - triplet_acc: 0.9703 - val_loss: 5.3833 - val_triplet_acc: 0.4000
Beginning epoch number: 128
Current hard triplet ratio: 0.9786154367333848
300/300 [==============================] - 218s 726ms/step - loss: 0.0506 - triplet_acc: 0.9810 - val_loss: 5.5993 - val_triplet_acc: 0.4133
Beginning epoch number: 129
Current hard triplet ratio: 0.983269812295083
300/300 [==============================] - 218s 726ms/step - loss: 0.0759 - triplet_acc: 0.9717 - val_loss: 4.3511 - val_triplet_acc: 0.4200
Beginning epoch number: 130
Current hard triplet ratio: 0.9750181996952737
300/300 [==============================] - 217s 722ms/step - loss: 0.0642 - triplet_acc: 0.9773 - val_loss: 5.0351 - val_triplet_acc: 0.3933
Beginning epoch number: 131
Current hard triplet ratio: 0.9788228754256005
300/300 [==============================] - 215s 717ms/step - loss: 0.0720 - triplet_acc: 0.9750 - val_loss: 5.5248 - val_triplet_acc: 0.2867
Beginning epoch number: 132
Current hard triplet ratio: 0.9762696768081884
300/300 [==============================] - 215s 718ms/step - loss: 0.0655 - triplet_acc: 0.9797 - val_loss: 4.5968 - val_triplet_acc: 0.3667
Beginning epoch number: 133
Current hard triplet ratio: 0.978417700913706
300/300 [==============================] - 217s 723ms/step - loss: 0.0684 - triplet_acc: 0.9740 - val_loss: 4.6569 - val_triplet_acc: 0.3967
Beginning epoch number: 134
Current hard triplet ratio: 0.9774666746075912
300/300 [==============================] - 215s 716ms/step - loss: 0.0665 - triplet_acc: 0.9747 - val_loss: 5.4579 - val_triplet_acc: 0.3300
Beginning epoch number: 135
Current hard triplet ratio: 0.9780754327275744
300/300 [==============================] - 218s 727ms/step - loss: 0.0714 - triplet_acc: 0.9763 - val_loss: 4.3216 - val_triplet_acc: 0.3800
Beginning epoch number: 136
Current hard triplet ratio: 0.9764797102808274
300/300 [==============================] - 215s 718ms/step - loss: 0.0614 - triplet_acc: 0.9767 - val_loss: 4.9121 - val_triplet_acc: 0.3133
Beginning epoch number: 137
Current hard triplet ratio: 0.9797355215768736
300/300 [==============================] - 215s 717ms/step - loss: 0.0606 - triplet_acc: 0.9753 - val_loss: 3.6426 - val_triplet_acc: 0.4533
Beginning epoch number: 138
Current hard triplet ratio: 0.9800039572802683
300/300 [==============================] - 217s 724ms/step - loss: 0.0475 - triplet_acc: 0.9810 - val_loss: 5.9277 - val_triplet_acc: 0.3233
Beginning epoch number: 139
Current hard triplet ratio: 0.9842899018775354
300/300 [==============================] - 218s 726ms/step - loss: 0.0469 - triplet_acc: 0.9793 - val_loss: 5.7255 - val_triplet_acc: 0.4067
Beginning epoch number: 140
Current hard triplet ratio: 0.9844856740714527
300/300 [==============================] - 215s 718ms/step - loss: 0.0610 - triplet_acc: 0.9773 - val_loss: 4.7544 - val_triplet_acc: 0.3933
Beginning epoch number: 141
Current hard triplet ratio: 0.9798718182096794
300/300 [==============================] - 212s 708ms/step - loss: 0.0689 - triplet_acc: 0.9777 - val_loss: 5.2385 - val_triplet_acc: 0.3533
Beginning epoch number: 142
Current hard triplet ratio: 0.977297376339784
300/300 [==============================] - 213s 711ms/step - loss: 0.0344 - triplet_acc: 0.9857 - val_loss: 4.1271 - val_triplet_acc: 0.4300
Beginning epoch number: 143
Current hard triplet ratio: 0.9885857138641315
300/300 [==============================] - 215s 716ms/step - loss: 0.0640 - triplet_acc: 0.9753 - val_loss: 4.1552 - val_triplet_acc: 0.4233
Beginning epoch number: 144
Current hard triplet ratio: 0.9788997591290814
300/300 [==============================] - 213s 709ms/step - loss: 0.0624 - triplet_acc: 0.9800 - val_loss: 4.1489 - val_triplet_acc: 0.3867
Beginning epoch number: 145
Current hard triplet ratio: 0.9794034643796307
300/300 [==============================] - 214s 713ms/step - loss: 0.0738 - triplet_acc: 0.9727 - val_loss: 4.4182 - val_triplet_acc: 0.4367
Beginning epoch number: 146
Current hard triplet ratio: 0.9756915634635263
300/300 [==============================] - 218s 727ms/step - loss: 0.0506 - triplet_acc: 0.9797 - val_loss: 5.4605 - val_triplet_acc: 0.3567
Beginning epoch number: 147
Current hard triplet ratio: 0.9832764557159408
300/300 [==============================] - 215s 717ms/step - loss: 0.0771 - triplet_acc: 0.9727 - val_loss: 4.9378 - val_triplet_acc: 0.4200
Beginning epoch number: 148
Current hard triplet ratio: 0.9746242748058158
300/300 [==============================] - 215s 718ms/step - loss: 0.1028 - triplet_acc: 0.9693 - val_loss: 4.8579 - val_triplet_acc: 0.3633
Beginning epoch number: 149
Current hard triplet ratio: 0.9663288325309574
300/300 [==============================] - 216s 719ms/step - loss: 0.0501 - triplet_acc: 0.9823 - val_loss: 4.0725 - val_triplet_acc: 0.4533
Beginning epoch number: 150
Current hard triplet ratio: 0.9834430296530018
300/300 [==============================] - 217s 724ms/step - loss: 0.0368 - triplet_acc: 0.9857 - val_loss: 3.9578 - val_triplet_acc: 0.4733
Beginning epoch number: 151
Current hard triplet ratio: 0.9877956780739835
300/300 [==============================] - 218s 726ms/step - loss: 0.0568 - triplet_acc: 0.9780 - val_loss: 4.7429 - val_triplet_acc: 0.3933
Beginning epoch number: 152
Current hard triplet ratio: 0.9812582672954252
300/300 [==============================] - 217s 724ms/step - loss: 0.0516 - triplet_acc: 0.9793 - val_loss: 4.8700 - val_triplet_acc: 0.3833
Beginning epoch number: 153
Current hard triplet ratio: 0.9829395366644414
300/300 [==============================] - 215s 715ms/step - loss: 0.0492 - triplet_acc: 0.9797 - val_loss: 5.0559 - val_triplet_acc: 0.4233
Beginning epoch number: 154
Current hard triplet ratio: 0.983746738582262
300/300 [==============================] - 215s 717ms/step - loss: 0.0319 - triplet_acc: 0.9867 - val_loss: 5.2695 - val_triplet_acc: 0.4333
Beginning epoch number: 155
Current hard triplet ratio: 0.9894103213897321
300/300 [==============================] - 214s 715ms/step - loss: 0.0521 - triplet_acc: 0.9807 - val_loss: 4.4644 - val_triplet_acc: 0.3767
Beginning epoch number: 156
Current hard triplet ratio: 0.9827758243575699
300/300 [==============================] - 214s 714ms/step - loss: 0.0565 - triplet_acc: 0.9807 - val_loss: 5.5862 - val_triplet_acc: 0.3900
Beginning epoch number: 157
Current hard triplet ratio: 0.9813391576931461
300/300 [==============================] - 217s 724ms/step - loss: 0.0397 - triplet_acc: 0.9837 - val_loss: 4.7507 - val_triplet_acc: 0.3867
Beginning epoch number: 158
Current hard triplet ratio: 0.9868449880139014
300/300 [==============================] - 216s 719ms/step - loss: 0.0357 - triplet_acc: 0.9853 - val_loss: 5.0142 - val_triplet_acc: 0.3600
Beginning epoch number: 159
Current hard triplet ratio: 0.9881764502610252
300/300 [==============================] - 216s 720ms/step - loss: 0.0413 - triplet_acc: 0.9837 - val_loss: 6.0586 - val_triplet_acc: 0.3400
Beginning epoch number: 160
Current hard triplet ratio: 0.9863347928957822
300/300 [==============================] - 213s 711ms/step - loss: 0.0566 - triplet_acc: 0.9827 - val_loss: 4.4924 - val_triplet_acc: 0.3967
Beginning epoch number: 161
Current hard triplet ratio: 0.9813154868468797
300/300 [==============================] - 213s 711ms/step - loss: 0.0570 - triplet_acc: 0.9807 - val_loss: 4.1625 - val_triplet_acc: 0.4133
Beginning epoch number: 162
Current hard triplet ratio: 0.981177453013629
300/300 [==============================] - 213s 711ms/step - loss: 0.0424 - triplet_acc: 0.9823 - val_loss: 4.9012 - val_triplet_acc: 0.4367
Beginning epoch number: 163
Current hard triplet ratio: 0.9859645874211016
300/300 [==============================] - 216s 719ms/step - loss: 0.0401 - triplet_acc: 0.9850 - val_loss: 5.6485 - val_triplet_acc: 0.3500
Beginning epoch number: 164
Current hard triplet ratio: 0.9867218818416615
300/300 [==============================] - 213s 709ms/step - loss: 0.0367 - triplet_acc: 0.9850 - val_loss: 5.8325 - val_triplet_acc: 0.3033
Beginning epoch number: 165
Current hard triplet ratio: 0.9878337122575767
300/300 [==============================] - 215s 716ms/step - loss: 0.0347 - triplet_acc: 0.9863 - val_loss: 5.0569 - val_triplet_acc: 0.3967
Beginning epoch number: 166
Current hard triplet ratio: 0.988508947074707
300/300 [==============================] - 217s 722ms/step - loss: 0.0760 - triplet_acc: 0.9737 - val_loss: 5.2564 - val_triplet_acc: 0.4167
Beginning epoch number: 167
Current hard triplet ratio: 0.9749968618126936
300/300 [==============================] - 219s 729ms/step - loss: 0.0679 - triplet_acc: 0.9733 - val_loss: 5.5287 - val_triplet_acc: 0.3700
Beginning epoch number: 168
Current hard triplet ratio: 0.9776259819592342
300/300 [==============================] - 217s 722ms/step - loss: 0.0573 - triplet_acc: 0.9803 - val_loss: 5.2469 - val_triplet_acc: 0.3767
Beginning epoch number: 169
Current hard triplet ratio: 0.9810671217933826
300/300 [==============================] - 219s 730ms/step - loss: 0.0654 - triplet_acc: 0.9737 - val_loss: 4.4218 - val_triplet_acc: 0.4100
Beginning epoch number: 170
Current hard triplet ratio: 0.9784242763173049
300/300 [==============================] - 221s 736ms/step - loss: 0.0975 - triplet_acc: 0.9673 - val_loss: 5.2565 - val_triplet_acc: 0.3633
Beginning epoch number: 171
Current hard triplet ratio: 0.9680240256784547
300/300 [==============================] - 217s 722ms/step - loss: 0.0568 - triplet_acc: 0.9780 - val_loss: 5.0577 - val_triplet_acc: 0.4133
Beginning epoch number: 172
Current hard triplet ratio: 0.9812291957580339
300/300 [==============================] - 215s 718ms/step - loss: 0.0295 - triplet_acc: 0.9867 - val_loss: 5.6212 - val_triplet_acc: 0.4033
Beginning epoch number: 173
Current hard triplet ratio: 0.9902129172648635
300/300 [==============================] - 214s 715ms/step - loss: 0.0437 - triplet_acc: 0.9820 - val_loss: 4.6476 - val_triplet_acc: 0.4033
Beginning epoch number: 174
Current hard triplet ratio: 0.9855328456346053
300/300 [==============================] - 216s 720ms/step - loss: 0.0591 - triplet_acc: 0.9780 - val_loss: 4.5466 - val_triplet_acc: 0.4433
Beginning epoch number: 175
Current hard triplet ratio: 0.9804851363177549
300/300 [==============================] - 218s 727ms/step - loss: 0.0415 - triplet_acc: 0.9850 - val_loss: 4.5794 - val_triplet_acc: 0.3500
Beginning epoch number: 176
Current hard triplet ratio: 0.9862753198938017
300/300 [==============================] - 216s 720ms/step - loss: 0.0390 - triplet_acc: 0.9833 - val_loss: 4.9381 - val_triplet_acc: 0.4033
Beginning epoch number: 177
Current hard triplet ratio: 0.9870779632495312
300/300 [==============================] - 218s 726ms/step - loss: 0.0433 - triplet_acc: 0.9837 - val_loss: 5.4668 - val_triplet_acc: 0.3433
Beginning epoch number: 178
Current hard triplet ratio: 0.9856648803242614
300/300 [==============================] - 218s 726ms/step - loss: 0.0697 - triplet_acc: 0.9770 - val_loss: 6.2076 - val_triplet_acc: 0.3033
Beginning epoch number: 179
Current hard triplet ratio: 0.9770351100534002
300/300 [==============================] - 217s 725ms/step - loss: 0.0471 - triplet_acc: 0.9820 - val_loss: 4.5278 - val_triplet_acc: 0.4167
Beginning epoch number: 180
Current hard triplet ratio: 0.984433149610254
300/300 [==============================] - 217s 722ms/step - loss: 0.0488 - triplet_acc: 0.9807 - val_loss: 5.2476 - val_triplet_acc: 0.3933
Beginning epoch number: 181
Current hard triplet ratio: 0.9838532380896637
300/300 [==============================] - 216s 720ms/step - loss: 0.0420 - triplet_acc: 0.9837 - val_loss: 5.1134 - val_triplet_acc: 0.4167
Beginning epoch number: 182
Current hard triplet ratio: 0.9860837076975119
300/300 [==============================] - 216s 720ms/step - loss: 0.0660 - triplet_acc: 0.9777 - val_loss: 4.5911 - val_triplet_acc: 0.3933
Beginning epoch number: 183
Current hard triplet ratio: 0.9782309229926742
300/300 [==============================] - 214s 713ms/step - loss: 0.0539 - triplet_acc: 0.9807 - val_loss: 5.2936 - val_triplet_acc: 0.4133
Beginning epoch number: 184
Current hard triplet ratio: 0.9821976989889398
300/300 [==============================] - 217s 724ms/step - loss: 0.0378 - triplet_acc: 0.9850 - val_loss: 4.9763 - val_triplet_acc: 0.4300
Beginning epoch number: 185
Current hard triplet ratio: 0.9874889521331552
300/300 [==============================] - 219s 729ms/step - loss: 0.0540 - triplet_acc: 0.9810 - val_loss: 5.2155 - val_triplet_acc: 0.4267
Beginning epoch number: 186
Current hard triplet ratio: 0.9821464076452547
300/300 [==============================] - 215s 717ms/step - loss: 0.0408 - triplet_acc: 0.9860 - val_loss: 4.3552 - val_triplet_acc: 0.4700
Beginning epoch number: 187
Current hard triplet ratio: 0.9864860641630967
300/300 [==============================] - 212s 705ms/step - loss: 0.0298 - triplet_acc: 0.9867 - val_loss: 4.5505 - val_triplet_acc: 0.4267
Beginning epoch number: 188
Current hard triplet ratio: 0.9901309400877117
300/300 [==============================] - 213s 709ms/step - loss: 0.0288 - triplet_acc: 0.9880 - val_loss: 4.3247 - val_triplet_acc: 0.3833
Beginning epoch number: 189
Current hard triplet ratio: 0.9904524220317859
300/300 [==============================] - 214s 713ms/step - loss: 0.0326 - triplet_acc: 0.9880 - val_loss: 4.7871 - val_triplet_acc: 0.3933
Beginning epoch number: 190
Current hard triplet ratio: 0.9891955240857135
300/300 [==============================] - 215s 717ms/step - loss: 0.0384 - triplet_acc: 0.9860 - val_loss: 4.6170 - val_triplet_acc: 0.4133
Beginning epoch number: 191
Current hard triplet ratio: 0.9872921940785806
300/300 [==============================] - 215s 716ms/step - loss: 0.0595 - triplet_acc: 0.9763 - val_loss: 4.6092 - val_triplet_acc: 0.3967
Beginning epoch number: 192
Current hard triplet ratio: 0.9803682116523114
300/300 [==============================] - 215s 717ms/step - loss: 0.0498 - triplet_acc: 0.9813 - val_loss: 3.8785 - val_triplet_acc: 0.4400
Beginning epoch number: 193
Current hard triplet ratio: 0.9835425163718338
300/300 [==============================] - 217s 722ms/step - loss: 0.0757 - triplet_acc: 0.9743 - val_loss: 4.8068 - val_triplet_acc: 0.3533
Beginning epoch number: 194
Current hard triplet ratio: 0.9750804774069044
300/300 [==============================] - 214s 713ms/step - loss: 0.0498 - triplet_acc: 0.9823 - val_loss: 4.2718 - val_triplet_acc: 0.3667
Beginning epoch number: 195
Current hard triplet ratio: 0.9835460863175179
300/300 [==============================] - 215s 718ms/step - loss: 0.0513 - triplet_acc: 0.9837 - val_loss: 4.6438 - val_triplet_acc: 0.3767
Beginning epoch number: 196
Current hard triplet ratio: 0.983055137115878
300/300 [==============================] - 215s 718ms/step - loss: 0.0658 - triplet_acc: 0.9790 - val_loss: 4.4949 - val_triplet_acc: 0.3733
Beginning epoch number: 197
Current hard triplet ratio: 0.978304217771462
300/300 [==============================] - 214s 712ms/step - loss: 0.0379 - triplet_acc: 0.9853 - val_loss: 4.6287 - val_triplet_acc: 0.3800
Beginning epoch number: 198
Current hard triplet ratio: 0.9874371392422556
300/300 [==============================] - 218s 727ms/step - loss: 0.0526 - triplet_acc: 0.9797 - val_loss: 5.4709 - val_triplet_acc: 0.3833
Beginning epoch number: 199
Current hard triplet ratio: 0.9826037152874464
300/300 [==============================] - 218s 727ms/step - loss: 0.0677 - triplet_acc: 0.9747 - val_loss: 4.8712 - val_triplet_acc: 0.4133
Beginning epoch number: 200
Current hard triplet ratio: 0.9776941833174783
300/300 [==============================] - 214s 715ms/step - loss: 0.0735 - triplet_acc: 0.9757 - val_loss: 4.6155 - val_triplet_acc: 0.4500
Beginning epoch number: 201
Current hard triplet ratio: 0.9758106543197302
300/300 [==============================] - 215s 717ms/step - loss: 0.0530 - triplet_acc: 0.9827 - val_loss: 6.1012 - val_triplet_acc: 0.3733
Beginning epoch number: 202
Current hard triplet ratio: 0.9824932517477386
300/300 [==============================] - 215s 718ms/step - loss: 0.0436 - triplet_acc: 0.9827 - val_loss: 5.3627 - val_triplet_acc: 0.4000
Beginning epoch number: 203
Current hard triplet ratio: 0.9855871385095342
300/300 [==============================] - 217s 722ms/step - loss: 0.0356 - triplet_acc: 0.9867 - val_loss: 4.3297 - val_triplet_acc: 0.4100
Beginning epoch number: 204
Current hard triplet ratio: 0.9882139530338198
300/300 [==============================] - 216s 721ms/step - loss: 0.0388 - triplet_acc: 0.9857 - val_loss: 4.8099 - val_triplet_acc: 0.4033
Beginning epoch number: 205
Current hard triplet ratio: 0.9871435560140355
300/300 [==============================] - 217s 725ms/step - loss: 0.0532 - triplet_acc: 0.9817 - val_loss: 4.9919 - val_triplet_acc: 0.3400
Beginning epoch number: 206
Current hard triplet ratio: 0.9824200383838572
300/300 [==============================] - 218s 725ms/step - loss: 0.0520 - triplet_acc: 0.9797 - val_loss: 4.9723 - val_triplet_acc: 0.3500
Beginning epoch number: 207
Current hard triplet ratio: 0.9828196514447012
300/300 [==============================] - 217s 723ms/step - loss: 0.0483 - triplet_acc: 0.9827 - val_loss: 5.0860 - val_triplet_acc: 0.3833
Beginning epoch number: 208
Current hard triplet ratio: 0.9840368982372967
300/300 [==============================] - 218s 727ms/step - loss: 0.0243 - triplet_acc: 0.9890 - val_loss: 5.0093 - val_triplet_acc: 0.3667
Beginning epoch number: 209
Current hard triplet ratio: 0.9919343826426564
300/300 [==============================] - 217s 723ms/step - loss: 0.0539 - triplet_acc: 0.9807 - val_loss: 4.4345 - val_triplet_acc: 0.4500
Beginning epoch number: 210
Current hard triplet ratio: 0.9821780480689339
300/300 [==============================] - 218s 726ms/step - loss: 0.0428 - triplet_acc: 0.9827 - val_loss: 5.2386 - val_triplet_acc: 0.3767
Beginning epoch number: 211
Current hard triplet ratio: 0.9858245040915807
300/300 [==============================] - 216s 719ms/step - loss: 0.0394 - triplet_acc: 0.9813 - val_loss: 4.5858 - val_triplet_acc: 0.3900
Beginning epoch number: 212
Current hard triplet ratio: 0.9869485850088915
300/300 [==============================] - 216s 719ms/step - loss: 0.0622 - triplet_acc: 0.9810 - val_loss: 6.1550 - val_triplet_acc: 0.3600
Beginning epoch number: 213
Current hard triplet ratio: 0.9794647074112754
300/300 [==============================] - 217s 722ms/step - loss: 0.0711 - triplet_acc: 0.9760 - val_loss: 5.1747 - val_triplet_acc: 0.3900
Beginning epoch number: 214
Current hard triplet ratio: 0.9765933334628014
300/300 [==============================] - 218s 725ms/step - loss: 0.0306 - triplet_acc: 0.9887 - val_loss: 5.6281 - val_triplet_acc: 0.4033
Beginning epoch number: 215
Current hard triplet ratio: 0.9898667171094481
300/300 [==============================] - 217s 724ms/step - loss: 0.0535 - triplet_acc: 0.9827 - val_loss: 4.7547 - val_triplet_acc: 0.4067
Beginning epoch number: 216
Current hard triplet ratio: 0.9823364508917735
300/300 [==============================] - 218s 726ms/step - loss: 0.0387 - triplet_acc: 0.9827 - val_loss: 4.7200 - val_triplet_acc: 0.4567
Beginning epoch number: 217
Current hard triplet ratio: 0.9871856336794111
300/300 [==============================] - 216s 720ms/step - loss: 0.0451 - triplet_acc: 0.9857 - val_loss: 4.4099 - val_triplet_acc: 0.3633
Beginning epoch number: 218
Current hard triplet ratio: 0.9850820205862247
300/300 [==============================] - 217s 722ms/step - loss: 0.0362 - triplet_acc: 0.9873 - val_loss: 4.3446 - val_triplet_acc: 0.3700
Beginning epoch number: 219
Current hard triplet ratio: 0.9880034064455946
300/300 [==============================] - 218s 726ms/step - loss: 0.0420 - triplet_acc: 0.9877 - val_loss: 4.6428 - val_triplet_acc: 0.3800
Beginning epoch number: 220
Current hard triplet ratio: 0.986100511416639
300/300 [==============================] - 216s 721ms/step - loss: 0.0488 - triplet_acc: 0.9823 - val_loss: 3.2851 - val_triplet_acc: 0.4533
Beginning epoch number: 221
Current hard triplet ratio: 0.9838696409447901
300/300 [==============================] - 212s 706ms/step - loss: 0.0243 - triplet_acc: 0.9900 - val_loss: 4.2891 - val_triplet_acc: 0.4033
Beginning epoch number: 222
Current hard triplet ratio: 0.9919195377287219
300/300 [==============================] - 215s 716ms/step - loss: 0.0351 - triplet_acc: 0.9850 - val_loss: 4.7984 - val_triplet_acc: 0.4567
Beginning epoch number: 223
Current hard triplet ratio: 0.988384593770798
300/300 [==============================] - 216s 719ms/step - loss: 0.0383 - triplet_acc: 0.9870 - val_loss: 4.6773 - val_triplet_acc: 0.4067
Beginning epoch number: 224
Current hard triplet ratio: 0.9873237268737383
300/300 [==============================] - 216s 720ms/step - loss: 0.0508 - triplet_acc: 0.9810 - val_loss: 4.3524 - val_triplet_acc: 0.4533
Beginning epoch number: 225
Current hard triplet ratio: 0.9832200228657693
300/300 [==============================] - 216s 721ms/step - loss: 0.0466 - triplet_acc: 0.9813 - val_loss: 4.4914 - val_triplet_acc: 0.3967
Beginning epoch number: 226
Current hard triplet ratio: 0.9845915297782407
300/300 [==============================] - 218s 726ms/step - loss: 0.0571 - triplet_acc: 0.9807 - val_loss: 3.7890 - val_triplet_acc: 0.4700
Beginning epoch number: 227
Current hard triplet ratio: 0.9811358190642478
300/300 [==============================] - 214s 714ms/step - loss: 0.0604 - triplet_acc: 0.9793 - val_loss: 5.6200 - val_triplet_acc: 0.3733
Beginning epoch number: 228
Current hard triplet ratio: 0.9800726604283669
300/300 [==============================] - 217s 723ms/step - loss: 0.0402 - triplet_acc: 0.9850 - val_loss: 4.4303 - val_triplet_acc: 0.3933
Beginning epoch number: 229
Current hard triplet ratio: 0.9866743325093112
300/300 [==============================] - 215s 718ms/step - loss: 0.0489 - triplet_acc: 0.9853 - val_loss: 4.3920 - val_triplet_acc: 0.3733
Beginning epoch number: 230
Current hard triplet ratio: 0.9838307637144855
300/300 [==============================] - 217s 723ms/step - loss: 0.0221 - triplet_acc: 0.9910 - val_loss: 4.5560 - val_triplet_acc: 0.3933
Beginning epoch number: 231
Current hard triplet ratio: 0.9926469631752933
300/300 [==============================] - 216s 719ms/step - loss: 0.0403 - triplet_acc: 0.9853 - val_loss: 4.3438 - val_triplet_acc: 0.4467
Beginning epoch number: 232
Current hard triplet ratio: 0.9866666283805131
300/300 [==============================] - 217s 723ms/step - loss: 0.0300 - triplet_acc: 0.9893 - val_loss: 4.2916 - val_triplet_acc: 0.4067
Beginning epoch number: 233
Current hard triplet ratio: 0.9900393889779056
300/300 [==============================] - 217s 724ms/step - loss: 0.0469 - triplet_acc: 0.9860 - val_loss: 4.3055 - val_triplet_acc: 0.3867
Beginning epoch number: 234
Current hard triplet ratio: 0.984499646103786
300/300 [==============================] - 217s 723ms/step - loss: 0.0390 - triplet_acc: 0.9847 - val_loss: 4.5860 - val_triplet_acc: 0.4233
Beginning epoch number: 235
Current hard triplet ratio: 0.9870896627906868
300/300 [==============================] - 219s 730ms/step - loss: 0.0582 - triplet_acc: 0.9807 - val_loss: 4.5959 - val_triplet_acc: 0.4200
Beginning epoch number: 236
Current hard triplet ratio: 0.9807900351111556
300/300 [==============================] - 218s 728ms/step - loss: 0.0692 - triplet_acc: 0.9753 - val_loss: 4.5538 - val_triplet_acc: 0.4100
Beginning epoch number: 237
Current hard triplet ratio: 0.9771899447030595
300/300 [==============================] - 215s 717ms/step - loss: 0.0507 - triplet_acc: 0.9827 - val_loss: 4.7674 - val_triplet_acc: 0.3733
Beginning epoch number: 238
Current hard triplet ratio: 0.9832519872455792
300/300 [==============================] - 215s 717ms/step - loss: 0.0368 - triplet_acc: 0.9860 - val_loss: 4.9024 - val_triplet_acc: 0.4167
Beginning epoch number: 239
Current hard triplet ratio: 0.9877968249536455
300/300 [==============================] - 214s 714ms/step - loss: 0.0464 - triplet_acc: 0.9840 - val_loss: 4.8771 - val_triplet_acc: 0.4100
Beginning epoch number: 240
Current hard triplet ratio: 0.9846576029072505
300/300 [==============================] - 216s 721ms/step - loss: 0.0471 - triplet_acc: 0.9820 - val_loss: 4.6489 - val_triplet_acc: 0.4000
Beginning epoch number: 241
Current hard triplet ratio: 0.984428828318775
300/300 [==============================] - 216s 721ms/step - loss: 0.0589 - triplet_acc: 0.9783 - val_loss: 4.4978 - val_triplet_acc: 0.4033
Beginning epoch number: 242
Current hard triplet ratio: 0.9805556375259851
300/300 [==============================] - 218s 727ms/step - loss: 0.0558 - triplet_acc: 0.9807 - val_loss: 4.7905 - val_triplet_acc: 0.3700
Beginning epoch number: 243
Current hard triplet ratio: 0.9815698982279257
300/300 [==============================] - 216s 718ms/step - loss: 0.0280 - triplet_acc: 0.9877 - val_loss: 4.8215 - val_triplet_acc: 0.4100
Beginning epoch number: 244
Current hard triplet ratio: 0.9907128516865238
300/300 [==============================] - 215s 718ms/step - loss: 0.0192 - triplet_acc: 0.9927 - val_loss: 4.3608 - val_triplet_acc: 0.3900
Beginning epoch number: 245
Current hard triplet ratio: 0.9936099015940202
300/300 [==============================] - 215s 715ms/step - loss: 0.0333 - triplet_acc: 0.9877 - val_loss: 4.6206 - val_triplet_acc: 0.4333
Beginning epoch number: 246
Current hard triplet ratio: 0.9889485601673487
300/300 [==============================] - 217s 724ms/step - loss: 0.0229 - triplet_acc: 0.9903 - val_loss: 4.8716 - val_triplet_acc: 0.4100
Beginning epoch number: 247
Current hard triplet ratio: 0.9923819751245762
300/300 [==============================] - 217s 723ms/step - loss: 0.0662 - triplet_acc: 0.9750 - val_loss: 4.2822 - val_triplet_acc: 0.4300
Beginning epoch number: 248
Current hard triplet ratio: 0.9781606533057964
300/300 [==============================] - 216s 720ms/step - loss: 0.0663 - triplet_acc: 0.9810 - val_loss: 5.1841 - val_triplet_acc: 0.3400
Beginning epoch number: 249
Current hard triplet ratio: 0.9781486284028164
300/300 [==============================] - 216s 721ms/step - loss: 0.0359 - triplet_acc: 0.9867 - val_loss: 5.3477 - val_triplet_acc: 0.3433